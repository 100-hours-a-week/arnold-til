# TIL Template

## 날짜: YYYY-MM-DD

### 스크럼
- 수업 내용 정리하기
- TIL 작성하기

### 새로 배운 내용
# 프로세스, 스레드

## 프로세스

- 실행중인 프로그램을 말한다.
- 독립적으로 실행되며, 독립적인 메모리 공간을 사용한다.
- ex) 크롬의 각 탭. (각 탭은 서로에게 영향을 주지 않고 독립적임)

### 프로세스의 메모리영역

- Code : 프로그램을 실행시키는 코드가 저장되어 있다.
- Data : global,  static 변수가 저장된다.
- Stack : local, parameter, return value들이 저장된다. 함수 호출과 관련된 value.
- Heap : 동적으로 할당받는 데이터들이 저장된다.

### 프로세스의 동작 흐름

- 로딩 : 실행한 프로그램이 OS로부터 메모리를 할당받는다.
- 실행 : CPU는 프로그램의 명령어를 실행한다.
- 대기 : I/O 등의 이벤트가 발생하면 대기상태에 들어간다.
- 종료 : 프로그램의 모든 작업이 완료되면 할당받은 자원을 해제하고 종료한다.

## 쓰레드

- 프로세스 안에서 실행되는 흐름 단위를 말한다.
- 실행되고 있는 프로세스의 자원을 공유하는 것이 수월하다.
- 여러 쓰레드를 생성하여 병렬 작업이 가능하다.
- 쓰레드는 서로에게 영향을 준다.

### 쓰레드 오버헤드

- 쓰레드를 사용하고 관리하는데 사용되는 자원.
- 과도하게 많이 사용한 쓰레드를 관리하려고 하면 오버헤드가 증가한다.
- 쓰레드가 많으면 좋긴 하지만 어디까지나 적당히. 트레이드 오프도 생각해야한다.

### 쓰레드의 동작 흐름

- 생성 : 프로세스를 실행 중 운영체제가 동적으로 쓰레드를 생성한다.
- 실행 : 각 쓰레드는 독립적으로 작업을 처리한다.
- 대기 : 쓰레드간 동기화가 필요하거나 외부 이벤트가 끝나기를 기다린다.
- 종료 : 쓰레드가 할당받은 자원을 해제하고 종료한다.

## 프로세스, 스레드를 활용하지 못했을 때 생기는 다양한 문제상황

- 각 서비스는 독립된 메모리 공간을 갖고 있어서 데이터 일관성을 유지하지 못한다.
- 프로세스의 생명주기를 제대로 이해하지 못하면 자원 누수-메모리 누수 등-가 발생할 수 있다.
- 정해진 수량만 판매해야 하는데 많은 사용자가 몰려서, 실제 수량보다 더 판매되는 동시성 문제가 발생할 수 있음

>💡동시성 vs 병렬성  
> 동시성 : 여러 작업이 번갈아가며 실행되는 것  
> 병렬성 : 여러 작업이 실제로 동시에 실행되는 것  
> 컴퓨터의 작업 속도가 매우 빨라서 순서대로 진행되는 것이 동시에 실행되는 것 처럼 보이는 것 → 동시성

</aside>

### Context Switching

- CPU에서 하나의 프로그램 실행을 중지하고 다른 프로그램을 실행할 수 있도록 운영체제에 기능이다.
- 기존에 실행중이던 프로세스(쓰레드)의 정보를 담고 있는 PCB, TCB가 context switching을 할 수 있게 해준다.

# 자바 쓰레드

## Thread vs Runnable

- Runnable은 인터페이스, Thread는 클래스이다.
- Runnable은 Thread에게 위임해서 실행해야 하고, Thread는 직접 실행할 수 있다.

### Synchronized

- 자바에서 동시성 관리를 위해 지원하는 키워드.
- 메서드 앞에 static과 같이 붙여서 메서드를 임계 영역으로 설정한다.

>💡 임계영역이란 둘 이상의 쓰레드가 하나의 자원에 동시에 접근하지 못하도록 일정 시간동안 정해 놓는 구역이다.

### Atomic class

- 자바에서 동시성 관리를 위해 지원하는 레퍼런스 타입.

### 자바에서의 동시성 관리

- Atomic 클래스, synchronized 등을 이용하여 동시성을 보장한다.

### Synchronized vs Atomic

- synchronized는 메서드 전체에 lock을 건다. 만약 메소드에 복잡한 로직이 들어간다면 쓰레드의 개수가 많을 때, 많은 시간이 걸릴 것이다.
- 반면 Atomic class는 non-blocking 방식을 사용하여 변수 단위 하나에 lock을 걸어서 시간이 오래 걸리지 않는다.

### 오늘의 도전 과제와 해결 방법
- CLI 프로그램에서 간단한 스레드 구현하기

### 오늘의 회고
- 대학교 3학년때 OS 시간에 배운 내용들이였지만 전체적인 흐름이나 내용을 대강 알고, 배웠다는 기억은 있지만 정확하게 이 내용들이 뭐였는지는 기억해내지 못했다. 강의를 듣고 직접 찾아가다보니 기억의 저편에서 배웠던 내용을 꺼내올 수 있었다. 오늘 배운 내용도 다시 잊지 않기 위해 TIL을 작성하고 들여다 봐야겠지... 

### 참고 자료 및 링크
- [Operating Systems: Three Easy Pieces](https://pages.cs.wisc.edu/~remzi/OSTEP/)
