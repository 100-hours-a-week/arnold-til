## 날짜: 2025-02-11

### 스크럼
- 학습 목표 1 : 어제 휴가로 인해 정리 못한 키워드 정리하기
- 학습 목표 2 : 과제 회고 마무리 하기

### 새로 배운 내용
# 공유 자원(Shared Resource)

- 둘 이상의 프로세스, 스레드가 동시에 접근 또는 사용하는 시스템 자원.
- 리소스를 낭비하지 않고, 메모리의 효율을 높이기 위해 사용된다.

# 임계 영역(Critical Section)

- 공유 자원을 공유하지만 두 개 이상의 스레드에서 동시에 접근하면 안되는 영역.

# 동기화(Synchronization)

### 원자성(Atomicity)

- 완전히 끝날 때 까지 실행하거나, 아예 실행을 하지 않거나, 중간에 멈추지 않는 것을 의미한다.

### 경쟁상태(Race Condition)

- 멀티 스레드가 임계 영역에 동시에 접근할 때 방생하는 문제.
- 멀티 스레드가 공유자원 업데이트를 시도하여 예상치 못한 문제가 발생한다.

## 동기화의 조건

### 상호배제(Mutex, Mutual Exclusion)

- 하나의 스레드가 임계영역에 접근하고 있을 때, 다른 스레드가 접근하지 못하도록 보장하는 것.
- Race Condition이 일어나지 않도록 하고, 결과를 예측할 수 있다.

### 진행(progress)

- 공유 자원을 사용하는 다른 프로세스(스레드)가 없으면 대기중인 프로세스가 즉시 실행되어야 한다.

### 유한한 대기(Bounded Wating)

- 사용 중인 공유 자원에 대해 다른 프로세스가 사용하기 위해 대기하는 시간이 유한해야 한다.

## 교착상태(DeadLock)

- 스레드간에 소유해야 하는 락의 순서가 꼬여서 스레드끼리 서로 원하는 lock을 서로가 갖고 기다리며 계속 기다리는 상태.

![Deadlock](https://github.com/user-attachments/assets/4c5e6b9c-6cc6-4e13-8229-8533d01399da)


```c
// Thread 1:
pthread_mutex_lock(L1);
pthread_mutex_lock(L2);

// Thread 2: 
pthread_mutex_lock(L2);
pthread_mutex_lock(L1);
```

- 발생 이유
  - 복잡한 종속성(complex dependencies) 때문.
  - 캡슐화 때문.
- 발생 조건 (이 조건들을 모두 만족하면 deadlock이 발생. 즉, 하나라도 충족되지 않으면 deadlock을 예방할 수 있음)
  - 자원을 동시에 갖고 있을 수 없다. → Mutex
  - 스레드가 기다리는 상황이 존재한다. → Hold and wait
  - lock을 뺏길 수 없다. → No preemption
  - 위 조건을 만족하며 cycle을 이뤄야 함. → Circular Wait
- deadlock 막는 방법
  - lock을 사용하지 않는 자료구조를 사용. → Compare and Swap
  - lock을 사용중이 아닌 대기중이라면 대기중이라고 return을 한다.
  - 타임 아웃을 설정하여 일정 시간내에 lock을 얻지 못하면 요청을 취소한다.
  - lock에 전체 순서를 부여하여 cycle을 방지.

## 조건 변수(Condition Variable)

- 스레드간에 신호를 주고 받아서 자원을 기다리는 스레드는 sleep상태에 들어가있고, 자원을 해제한 스레드는 sleep 상태에 있는 스레드를 깨우는 방법.
- 점유된 자원을 필요로 하는 스레드가 계속 CPU를 낭비하면서 기다릴 필요 없이 명시적 큐(explicit queue) 안에서 sleep 상태로 대기한다.

### 오늘의 도전 과제와 해결 방법
- 도전 과제 1: 2주차 과제 회고 마무리 하기
- 도전 과제 2: 어제 키워드 정리

### 오늘의 회고
- 휴가를 갔다 왔더니 굉장한 키워드들이 쌓여있었다. 이번 내용들도 금요일에 딥다이브 하면서 한번씩 맛봤던 내용도 있고, OS 수업 때 들었던 내용도 있고 충분히 할만 하다. 그래도 양 자체가 많기도 하고 내용도 어려운 내용이라 모든 키워드를 정리하지는 못했다.
- 열심히 데드락에 대해 공부했더니 내일 수업 때 할 내용이였다...
